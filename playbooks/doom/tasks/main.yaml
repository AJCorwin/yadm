---
- name: CD HOME
  ansible.builtin.shell: cd $HOME

- name: Uninstall emacs
  ansible.builtin.shell: sudo apt remove --autoremove emacs emacs-common
  become: yes
  # args:
  #  executable: /bin/bash

- name: Add emacs28
  ansible.builtin.apt_repository:
          repo: ppa:kelleyk/emacs
          become: yes

- name: Run apt update
  ansible.builtin.shell: sudo apt update
   become: yes

- name: Install Emacs28
  ansible.builtin.apt:
          name: emacs28
          become: yes

- name: Clone emacs
  ansible.builtin.git:
    repo: 'https://github.com/hlissner/doom-emacs'
    dest: ~/.emacs.d
    become: yes

- name: Install Doom
  ansible.builtin.shell: ~/.emacs.d/bin/doom install
  become: yes
  # args:
  #  executable: /bin/bash

- name: Run doom sync
  ansible.builtin.shell: ~/.emacs.d/bin/doom sync
  become: yes
  # args:
  #  executable: /bin/bash

- name: Run doom doctor
  ansible.builtin.shell: ~/.emacs.d/bin/doom doctor
  become: yes
  # args:
  #  executable: /bin/bash
